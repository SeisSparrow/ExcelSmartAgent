INFO:     Will watch for changes in these directories: ['/Users/zhennan/Documents/GithubRepos/ExcelSmartAgent']
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [78563] using WatchFiles
INFO:     Started server process [78578]
INFO:     Waiting for application startup.
2025-10-21 22:15:57,962 - backend.main - INFO - Starting Excel Smart Agent...
2025-10-21 22:15:57,962 - backend.main - INFO - Data path: /Users/zhennan/Documents/GithubRepos/ExcelSmartAgent/data/excel_files
2025-10-21 22:15:57,962 - backend.main - INFO - Processed data path: /Users/zhennan/Documents/GithubRepos/ExcelSmartAgent/data/processed
2025-10-21 22:15:57,962 - backend.main - INFO - Log path: /Users/zhennan/Documents/GithubRepos/ExcelSmartAgent/logs
INFO:     Application startup complete.
INFO:     ('127.0.0.1', 61967) - "WebSocket /ws" [accepted]
2025-10-21 22:15:58,007 - backend.api.websocket_handler - INFO - New WebSocket connection: 4897001168
INFO:     connection open
WARNING:  WatchFiles detected changes in 'backend/core/llm_agent.py'. Reloading...
INFO:     Shutting down
2025-10-21 22:16:25,232 - backend.api.websocket_handler - ERROR - WebSocket error: Cannot call "receive" once a disconnect message has been received.
2025-10-21 22:16:25,232 - backend.api.websocket_handler - ERROR - Error sending message: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-10-21 22:16:25,232 - backend.api.websocket_handler - INFO - WebSocket disconnected: 4897001168
INFO:     connection closed
INFO:     Waiting for application shutdown.
2025-10-21 22:16:25,333 - backend.main - INFO - Shutting down Excel Smart Agent...
INFO:     Application shutdown complete.
INFO:     Finished server process [78578]
INFO:     Started server process [78816]
INFO:     Waiting for application startup.
2025-10-21 22:16:26,461 - backend.main - INFO - Starting Excel Smart Agent...
2025-10-21 22:16:26,462 - backend.main - INFO - Data path: /Users/zhennan/Documents/GithubRepos/ExcelSmartAgent/data/excel_files
2025-10-21 22:16:26,462 - backend.main - INFO - Processed data path: /Users/zhennan/Documents/GithubRepos/ExcelSmartAgent/data/processed
2025-10-21 22:16:26,462 - backend.main - INFO - Log path: /Users/zhennan/Documents/GithubRepos/ExcelSmartAgent/logs
INFO:     Application startup complete.
INFO:     ('127.0.0.1', 62009) - "WebSocket /ws" [accepted]
2025-10-21 22:16:28,242 - backend.api.websocket_handler - INFO - New WebSocket connection: 4928576720
INFO:     connection open
INFO:     127.0.0.1:62031 - "GET / HTTP/1.1" 304 Not Modified
2025-10-21 22:17:01,316 - backend.api.websocket_handler - ERROR - WebSocket error: Cannot call "receive" once a disconnect message has been received.
2025-10-21 22:17:01,317 - backend.api.websocket_handler - ERROR - Error sending message: Unexpected ASGI message 'websocket.send', after sending 'websocket.close' or response already completed.
2025-10-21 22:17:01,317 - backend.api.websocket_handler - INFO - WebSocket disconnected: 4928576720
INFO:     connection closed
INFO:     127.0.0.1:62031 - "GET /src/styles/main.css HTTP/1.1" 304 Not Modified
INFO:     127.0.0.1:62032 - "GET /src/app.js HTTP/1.1" 304 Not Modified
INFO:     ('127.0.0.1', 62034) - "WebSocket /ws" [accepted]
2025-10-21 22:17:01,350 - backend.api.websocket_handler - INFO - New WebSocket connection: 4939852368
INFO:     connection open
2025-10-21 22:17:08,360 - backend.core.excel_processor - INFO - Converted date string column: 日期
INFO:     127.0.0.1:62036 - "POST /api/upload HTTP/1.1" 200 OK
2025-10-21 22:17:13,051 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-21 22:17:20,449 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
<string>:73: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
2025-10-21 22:17:26,167 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
